<% @facets.each do |facet| %>
  <% if !facet.abstract? && facet.visible? %>
    <% if @collapsible_facet_names.include? facet.name %>
      <% begin %>
        <%= render facet.view[:facet] || "#{params[:controller]}/facets/#{facet.name}_facet", facet: facet, translation: t(facet.key) %>
      <% rescue ActionView::MissingTemplate %>
        <%= render "facets/#{facet.type}_facet", facet: facet, translation: t(facet.key) %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
